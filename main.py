import telebot
from telebot import types
import time
from datetime import datetime

TOKEN = "8023087340:AAFRPkovu5PK9pBFVbFmo402NaahGuMaLsc"
ADMIN_ID = 572069105
bot = telebot.TeleBot(TOKEN)

# ====== –ì–ª–æ–±–∞–ª—å–Ω—ñ –∑–º—ñ–Ω–Ω—ñ ======
ALLOWED_USERS = set()
USER_STATE = {}
GIFT_CODES = {}
USERS_DB = {}

# ====== –ü–∞—Å—Ö–∞–ª–∫–∏ ======
EASTER_EGGS = {
    "—Å—é—Ä–ø—Ä–∏–∑": "üéÅ –©–æ—Å—å —á–µ–∫–∞—î –ø–æ–ø–µ—Ä–µ–¥—É...",
    "–∑–Ω–æ–≤—É": "üîÅ –°—Ö–æ–∂–µ, –∫–æ–º—É—Å—å —Å–ø–æ–¥–æ–±–∞–ª–æ—Å—å üòâ",
    "–≥–∞—Ä—è—á–µ": "üî• –¢–æ—á–Ω–æ –≥–∞—Ä—è—á—ñ—à–µ, –Ω—ñ–∂ —É—á–æ—Ä–∞‚Ä¶",
    "–ª–∏—Å–∏—á–∫–∞": "ü¶ä –ù—É —Ç–∏ –π –∑–Ω–∞–π—à–ª–∞ –º–µ–Ω–µ! –•–æ—á–µ—à —â–µ –æ–¥–Ω—É –ø—ñ–¥–∫–∞–∑–∫—É?",
    "foxie": "Foxie –∑–∞–≤–∂–¥–∏ –ø–æ—Ä—É—á. –ù–∞–≤—ñ—Ç—å –∫–æ–ª–∏ —Ç–∏ –Ω–µ –≥—Ä–∞—î—à.",
    "–Ω—ñ—á": "–ù—ñ—á ‚Äî —Ü–µ –ª–∏—à–µ –ø–æ—á–∞—Ç–æ–∫. –ü–∏—à–∏ –Ω–∞—Å—Ç—É–ø–Ω–µ —Å–ª–æ–≤–æ.",
    "–≤–æ–≥–æ–Ω—å": "üî• –£ —Ü—ñ–π –≥—Ä—ñ –º–æ–∂–µ –∑–∞–≥–æ—Ä—ñ—Ç–∏—Å—å –Ω–µ —Ç—ñ–ª—å–∫–∏ —Å–µ—Ä—Ü–µ.",
    "–≥—Ä–∞–π": "–ì—Ä–∞–π –Ω—ñ–∂–Ω–æ. –ê–ª–µ –¥–æ –∫—ñ–Ω—Ü—è.",
    "—Ç–∞–Ω–µ—Ü—å": "–ù–∞–≤—ñ—Ç—å —Ç—ñ–ª–∞ –∑–Ω–∞—é—Ç—å, –∫–æ–ª–∏ —á–∞—Å —Ä—É—Ö–∞—Ç–∏—Å—å —Ä–∞–∑–æ–º.",
    "–º–∞—Ä–∫–µ—Ä": "–ù–µ –±—ñ–π—Å—è –∑–∞–ª–∏—à–∏—Ç–∏ —Å–ª—ñ–¥. –í—ñ–Ω –∑–º–∏—î—Ç—å—Å—è‚Ä¶ –∞–±–æ –Ω—ñ üòâ",
    "—Ç–∞—î–º–Ω–∏—Ü—è": "–¢—Å—Å‚Ä¶ –∑–±–µ—Ä–µ–∂–∏ —ó—ó –¥–æ –∫—ñ–Ω—Ü—è –≥—Ä–∏.",
    "–ø–æ–≥–ª—è–¥": "–û–¥–∏–Ω –ø–æ–≥–ª—è–¥ ‚Äî —ñ —è –≤–∂–µ —Ç—É—Ç. –ü—Ä–æ–¥–æ–≤–∂—É–π‚Ä¶",
    "–º—Ä—ñ—è": "–¶–µ –≥—Ä–∞ ‚Äî –∞–±–æ —Ç–≤–æ—è –º—Ä—ñ—è —Å—Ç–∞–ª–∞ —Ä–µ–∞–ª—å–Ω—ñ—Å—Ç—é?",
}

REMINDER_TEXTS = [
    "–ê –ø–∞–º‚Äô—è—Ç–∞—î—à, —è–∫ —Ü–µ –±—É–ª–æ –≤–ø–µ—Ä—à–µ? ü¶ä –ú–æ–∂–µ, –ø–æ–≤—Ç–æ—Ä–∏–º–æ? Foxie –≤—Å–µ —â–µ —Ç—É—Ç‚Ä¶",
    "3 –º—ñ—Å—è—Ü—ñ –±–µ–∑ –ø—Ä–∏–≥–æ–¥? Foxie —Ç—Ä–æ—Ö–∏ —Å—É–º—É—î. –•–æ—á–µ—à –∑—ñ–≥—Ä–∞—Ç–∏ –∑–Ω–æ–≤—É?",
    "–î–µ—è–∫—ñ —Ä–µ—á—ñ –≤–∞—Ä—Ç–æ –ø–æ–≤—Ç–æ—Ä—é–≤–∞—Ç–∏‚Ä¶ –∑ –Ω–æ–≤–∏–º –Ω–∞—Å—Ç—Ä–æ—î–º. Foxie –Ω–∞ —Ç–µ–±–µ —á–µ–∫–∞—î üòà",
    "–ê –º–æ–∂–µ, –≤–∂–µ —á–∞—Å –¥–ª—è –Ω–æ–≤–æ–≥–æ —Ä—ñ–≤–Ω—è? Foxie –Ω–µ –∑–∞–±—É–≤–∞—î —Å–≤–æ—ó—Ö –ª–∏—Å–∏—á–æ–∫ ü¶ä"
]

COMMANDS_LIST = {
    "1": {
        "words": {
            "touch": "–®–∏—è", "moon": "–ü–ª–µ—á–µ", "kiss": "–ó–∞–ø‚Äô—è—Å—Ç—è", "hot": "–í–Ω—É—Ç—Ä—ñ—à–Ω—è —Å—Ç–æ—Ä–æ–Ω–∞ —Ä—É–∫–∏", "fire": "–°—Ç–µ–≥–Ω–æ",
            "love": "–ñ–∏–≤—ñ—Ç", "yes": "–õ–∏—Ç–∫–∞", "secret": "–¢–∞–ª—ñ—è", "open": "–í–Ω—É—Ç—Ä—ñ—à–Ω—è —Å—Ç–æ—Ä–æ–Ω–∞ —Å—Ç–µ–≥–Ω–∞", "lock": "–ü—ñ–¥–±–æ—Ä—ñ–¥–¥—è",
            "mine": "–ö–æ–ª—ñ–Ω–æ", "blind": "–ì—Ä—É–¥–∏", "claim": "–ü–∞–ª—å—Ü—ñ —Ä—É–∫", "tease": "–õ—ñ–∫—Ç—å–æ–≤–∏–π –∑–≥–∏–Ω", "wild": "–©–æ–∫–∞",
            "slide": "–°—ñ–¥–Ω–∏—Ü—è", "whisper": "–ì–æ–º—ñ–ª–∫–∞", "catch": "–®–∏—è –∑–∑–∞–¥—É", "freeze": "–ñ–∏–≤—ñ—Ç –∑–Ω–∏–∑—É", "hunt": "–ñ–∏–≤—ñ—Ç –∑–±–æ–∫—É"
        },
        "replies": {
            "touch": "–ù–µ –ø–∏—Ç–∞–π ‚Äî –ø—Ä–æ—Å—Ç–æ —Ç–æ—Ä–∫–Ω–∏—Å—å. –¢–∞–º, –¥–µ —Ç–æ–±—ñ —Ö–æ—á–µ—Ç—å—Å—è.",
            "moon": "–¢–æ—Ä–∫–Ω–∏—Å—å —Ç—ñ–ª—å–∫–∏ –Ω–æ—Å–æ–º. –í–µ–¥–∏ –ª—ñ–Ω—ñ—é –ø–æ–≤—ñ–ª—å–Ω–æ. –ì—É–±–∞–º ‚Äî –∑–∞–±–æ—Ä–æ–Ω–µ–Ω–æ.",
            "kiss": "–¢—Ä–∏ –ø–æ—Ü—ñ–ª—É–Ω–∫–∏. –¢–∞–º, –¥–µ —è –Ω–µ —á–µ–∫–∞—é. –¢—ñ–ª—å–∫–∏ –Ω–µ –Ω–∞ –≥—É–±–∞—Ö.",
            "hot": "–ó—Ä–æ–±–∏ –≥–∞—Ä—è—á—ñ—à–µ. –¢–∏ –º–∞—î—à —Ç—Ä–∏ —Ä—É—Ö–∏ ‚Äî —ñ –∂–æ–¥–Ω–æ–≥–æ —Å–ª–æ–≤–∞.",
            "fire": "–ó–Ω—ñ–º–∏ —â–æ—Å—å —ñ–∑ –º–µ–Ω–µ. –°–∫–∞–∂–∏: ‚Äú–ú–æ—î‚Äù. –Ü –ø—Ä–∏—Ç–∏—Å–Ω–∏ –º–µ–Ω–µ –±–ª–∏–∂—á–µ.",
            "love": "–¢–æ—Ä–∫–Ω–∏—Å—å —Ç–∞–∫, —â–æ–± –Ω–∞ –º–∏—Ç—å –ø–µ—Ä–µ—Ö–æ–ø–∏–ª–æ –ø–æ–¥–∏—Ö. –û–¥–∏–Ω –¥–æ—Ç–∏–∫. –Ü –∂–æ–¥–Ω–∏—Ö –ø–æ–≤—Ç–æ—Ä—ñ–≤.",
            "yes": "–ó–∞–ø–∏—Ç–∞–π —Ç—Ä–∏—á—ñ –ø–æ—à–µ–ø–∫–∏: ¬´–¢–∏ —Ö–æ—á–µ—à, —â–æ–± —è‚Ä¶?¬ª –Ø–∫—â–æ —Ç—Ä–∏—á—ñ –æ—Ç—Ä–∏–º–∞—î—à ‚Äú—Ç–∞–∫‚Äù ‚Äî —Ä–æ–±–∏ —â–æ —Ö–æ—á–µ—à. –ê–ª–µ –Ω—ñ–∂–Ω–æ. –ü–æ–∫–∏ —â–æ.",
            "secret": "–ü–æ—Ü—ñ–ª—É–π —Ç–∞–∫, —â–æ–± —Ç–∏—à–∞ –∑–Ω–∏–∫–ª–∞. –Ø–∫—â–æ –≤–∏–π–¥–µ ‚Äî –æ—Ç—Ä–∏–º–∞—î—à –º–æ—é —Ç–∞—î–º–Ω–∏—Ü—é. –ú–æ–∂–µ—à —Å–ø–∏—Ç–∞—Ç–∏ –≤—Å–µ, —â–æ —Ö–æ—á–µ—à.",
            "open": "–ó–Ω—ñ–º–∏ –æ–¥–Ω—É —Ä—ñ—á. –ù–∞–∑–≤–∏ —Ü–µ ‚Äú–≤—ñ–¥–∫—Ä–∏—Ç—Ç—è–º‚Äù. –Ü –ø–æ—Ü—ñ–ª—É–π.",
            "lock": "–°–∫–∞–∂–∏ —ñ–º‚Äô—è –ø–æ—à–µ–ø–∫–∏. –ü–æ—Ç—ñ–º —Ç—Ä–∏ –ø–æ—Ü—ñ–ª—É–Ω–∫–∏: —è–∫ —É –ø–µ—Ä—à–∏–π –¥–µ–Ω—å, —è–∫ —É —Å–≤–æ—ó—Ö –º—Ä—ñ—è—Ö, —è–∫ —â–µ –Ω–µ –±—É–ª–æ. –Ø–∫—â–æ –≤—Å—ñ —Ç—Ä–∏ –ø—Ä–∏–π–Ω—è—Ç—ñ ‚Äî –∑–∞–º–æ–∫ –∑–Ω—è—Ç–æ. –ü—Ä–æ—Å–∏, —á–æ–≥–æ —Ö–æ—á–µ—à.",
            "mine": "–û–±–≤–µ–¥–∏ –ø–∞–ª—å—Ü–µ–º. –Ü —Å–∫–∞–∂–∏, —è–∫–∞ —á–∞—Å—Ç–∏–Ω–∞ ‚Äî —Ç–≤–æ—è.",
            "blind": "–ó–∞–∫—Ä–∏–π –æ—á—ñ. –î–∞–π —Ä—É–∫–∞–º ¬´–ø–æ–±–∞—á–∏—Ç–∏¬ª.",
            "claim": "–û–±—ñ–π–º–∏ –∑–∑–∞–¥—É. –ü—Ä–∏—Ç–∏—Å–Ω–∏—Å—å. –ü—Ä–æ—à–µ–ø–æ—á–∏: ¬´–¶–µ –≤—Å–µ –º–æ—î¬ª. –Ü –∑–∞–ª–∏—à –¥–æ—Ç–∏–∫, —è–∫–∏–π —Ü–µ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å.",
            "tease": "–ü—Ä–æ–≤–µ–¥–∏ —è–∑–∏–∫–æ–º –æ–¥–Ω—É –ª—ñ–Ω—ñ—é. –ü–æ—Ç—ñ–º –∑—É–ø–∏–Ω–∏—Å—å ‚Äî —ñ —Å–∫–∞–∂–∏, —á–æ–≥–æ –Ω–∞—Å–ø—Ä–∞–≤–¥—ñ —Ö–æ—á–µ—à. –ê–ª–µ —Ç—ñ–ª—å–∫–∏ –æ–¥–Ω–µ —Å–ª–æ–≤–æ.",
            "wild": "–£—è–≤–∏, —â–æ —è —Ç–≤–æ—è –∑–¥–æ–±–∏—á. –£ —Ç–µ–±–µ 10 —Å–µ–∫—É–Ω–¥ –Ω–∞ –ø–µ—Ä—à–∏–π –Ω–∞–ø–∞–¥. –ú–∞—î –±—É—Ç–∏ —Ç–∏—Ö–æ. –ê–ª–µ —Ö–∏–∂–æ. –Ø–∫—â–æ –º–æ—î —Ç—ñ–ª–æ –Ω–µ –≤—ñ–¥–≥—É–∫–Ω–µ—Ç—å—Å—è ‚Äî —Ç–µ–ø–µ—Ä —Ö–∏–∂–∞–∫–æ–º —Å—Ç–∞–Ω—É —è.",
            "slide": "–ü–æ–≤–∑–∏ –ø–∞–ª—å—Ü–µ–º, –Ω—ñ–±–∏ —Ç–∏ —Ä–∞–≤–ª–∏–∫ –Ω–∞ –º—ñ—Å—ñ—ó. –ê–ª–µ –ø–∞–º‚Äô—è—Ç–∞–π: —Ñ—ñ–Ω—ñ—à ‚Äî —Ü–µ –º–æ—è —É—Å–º—ñ—à–∫–∞.",
            "whisper": "–ù–∞—à–µ–ø—á–∏ —â–æ—Å—å‚Ä¶ –∞–ª–µ –Ω–µ —Å–µ–∫—Å—É–∞–ª—å–Ω–µ. –©–æ—Å—å –ø—Ä–æ –±–æ—Ä—â, –ø–æ–¥–∞—Ç–∫–∏ –∞–±–æ —Å–∞–Ω—Ç–µ—Ö–Ω—ñ–∫–∞. –ü–æ–±–∞—á–∏–º–æ, —è–∫ –¥–æ–≤–≥–æ —è –≤–∏—Ç—Ä–∏–º–∞—é —Å–µ—Ä–π–æ–∑–Ω–æ.",
            "catch": "–£—è–≤–∏, —â–æ –Ω–∞ –º–µ–Ω—ñ –∑–∞—Ö–æ–≤–∞–Ω–∞ —Ç–∞—î–º–Ω–∞ –∫–Ω–æ–ø–∫–∞. –ó–Ω–∞–π–¥–∏ —ó—ó‚Ä¶ –∞–ª–µ –º–∞—î—à –ª–∏—à–µ 30 —Å–µ–∫—É–Ω–¥. –°—Ç–∞—Ä—Ç!",
            "freeze": "–¢–æ—Ä–∫–Ω–∏—Å—å ‚Äî —ñ —è –∑–∞–≤–º–∏—Ä–∞—é. –¢–≤–æ—è —Ä–æ–ª—å ‚Äî –ø—Ä–æ–≤–æ–∫—É–≤–∞—Ç–∏. –ú–æ—è ‚Äî –Ω–µ —Ä—É—Ö–∞—Ç–∏—Å—å. –Ø–∫—â–æ —è –ø—Ä–æ–≥—Ä–∞—é ‚Äî –º–∞—î—à –ø—Ä–∞–≤–æ –Ω–∞ —â–µ –æ–¥–Ω–µ —Ç–æ—Ä–∫–∞–Ω–Ω—è –¥–µ –∑–∞–≤–≥–æ–¥–Ω–æ.",
            "hunt": "–Ø ‚Äî –∑–¥–æ–±–∏—á. –¢–∏ ‚Äî —Ö–∏–∂–∞–∫. –ü—ñ–¥–∫—Ä–∞–¥–∞–π—Å—è –ø–æ–≤—ñ–ª—å–Ω–æ, –º–æ–≤—á–∫–∏. –Ü —Å—Ö–æ–ø–∏ —Ç–∞–∫, —â–æ–± –Ω–µ –≤—Å—Ç–∏–≥(–ª–∞) –∑—Ä–µ–∞–≥—É–≤–∞—Ç–∏. –¢–µ–ø–µ—Ä —è –≤ —Ç–≤–æ—ó—Ö –ª–∞–ø–∞—Ö."
        },
    },
    "2": {
        "words": {
            "drip": "–®–∏—è", "echo": "–ü–ª–µ—á–µ", "bite": "–ó–∞–ø‚Äô—è—Å—Ç—è", "mark": "–í–Ω—É—Ç—Ä—ñ—à–Ω—è —Å—Ç–æ—Ä–æ–Ω–∞ —Ä—É–∫–∏", "fold": "–°—Ç–µ–≥–Ω–æ",
            "burn": "–ñ–∏–≤—ñ—Ç", "howl": "–õ–∏—Ç–∫–∞", "lace": "–¢–∞–ª—ñ—è", "drift": "–í–Ω—É—Ç—Ä—ñ—à–Ω—è —Å—Ç–æ—Ä–æ–Ω–∞ —Å—Ç–µ–≥–Ω–∞", "trace": "–ü—ñ–¥–±–æ—Ä—ñ–¥–¥—è",
            "murmur": "–ö–æ–ª—ñ–Ω–æ", "sneak": "–ì—Ä—É–¥–∏", "melt": "–ü–∞–ª—å—Ü—ñ —Ä—É–∫", "nibble": "–õ—ñ–∫—Ç—å–æ–≤–∏–π –∑–≥–∏–Ω", "grip": "–©–æ–∫–∞",
            "spill": "–°—ñ–¥–Ω–∏—Ü—è", "sway": "–°—Ç–µ–≥–Ω–æ", "trap": "–®–∏—è", "glitch": "–ñ–∏–≤—ñ—Ç –∑–Ω–∏–∑—É", "anchor": "–ñ–∏–≤—ñ—Ç –∑–±–æ–∫—É"
        },
        "replies": {
            "drip": "–ü—Ä–æ–≤–µ–¥–∏ –∫—ñ–Ω—á–∏–∫–æ–º –ø–∞–ª—å—Ü—è, –Ω—ñ–±–∏ –∫–∞–ø–ª—è —â–æ–π–Ω–æ –≤–ø–∞–ª–∞. –ü–æ–≤—ñ–ª—å–Ω–æ, –≥–∞—Ä—è—á–æ—é –¥–æ—Ä—ñ–∂–∫–æ—é ‚Äî –≤—ñ–¥ –Ω–∞–π–≤–∏—â–æ—ó —Ç–æ—á–∫–∏, –∫—É–¥–∏ –∑–º–æ–∂–µ—à –¥–æ—Ç—è–≥–Ω—É—Ç–∏—Å—å‚Ä¶ –¥–æ –Ω–∞–π—Å–º—ñ–ª–∏–≤—ñ—à–æ—ó. –ê –ø–æ—Ç—ñ–º –∑—É–ø–∏–Ω–∏—Å—å. –Ü –ø–æ–¥–∏–≤–∏—Å—å –º–µ–Ω—ñ –≤ –æ—á—ñ. –ë–µ–∑ —É—Å–º—ñ—à–∫–∏. –ë–µ–∑ —Å–ª—ñ–≤. –ù–∞—á–µ —Ü–µ ‚Äî —Ç–≤—ñ–π —Ä–∏—Ç—É–∞–ª.",
            "echo": "–ü–æ–≤—Ç–æ—Ä–∏ –º—ñ–π —Ä—É—Ö. –¢–æ—á–Ω–æ. –ê–ª–µ –∑ –≤–ª–∞—Å–Ω–∏–º –≤—ñ–¥—Ç—ñ–Ω–∫–æ–º ‚Äî –ø–æ–≤—ñ–ª—å–Ω—ñ—à–µ, –Ω—ñ–∂–Ω—ñ—à–µ, –≥–ª–∏–±—à–µ. –ó—Ä–æ–±–∏ —Ç–∞–∫, —â–æ–± –ø–æ–≤—ñ—Ä–∏—Ç–∏: —Ç–∏ –∑—Ä–æ–∑—É–º—ñ–≤(–ª–∞) –º–µ–Ω–µ –∫—Ä–∞—â–µ, –Ω—ñ–∂ —è —Å–µ–±–µ. –û–¥–∏–Ω –∂–µ—Å—Ç ‚Äî —Ç–≤–æ—è –≤—ñ–¥–ø–æ–≤—ñ–¥—å –Ω–∞ –º—ñ–π.",
            "bite": "–ó–∞–ª–∏—à–∏ —Å–ª—ñ–¥. –ê–ª–µ –Ω–µ –ø—Ä–æ—Å—Ç–æ —Ç–∞–∫. –û–±–µ—Ä–∏ –º—ñ—Å—Ü–µ ‚Äî —Ç–∞–º, –¥–µ –Ω–∞–π–±—ñ–ª—å—à–µ —Ö–æ—á–µ—à –≤–æ–ª–æ–¥—ñ—Ç–∏. –û–¥–∏–Ω —É–∫—É—Å. –ë–µ–∑ –∂–∞–ª—é. –©–æ–± –º–∏ —â–µ –¥–æ–≤–≥–æ –∑–≥–∞–¥—É–≤–∞–ª–∏ —Ö—Ç–æ —á–∏–π.",
            "mark": "–ü—Ä–æ–≤–µ–¥–∏ –Ω–µ–≤–∏–¥–∏–º—É –ª—ñ–Ω—ñ—é. –ü–æ–≤—ñ–ª—å–Ω–æ, —è–∑–∏–∫–æ–º. –°–∞–º–æ—Å—Ç—ñ–π–Ω–æ –æ–±–µ—Ä–∏, –¥–µ –ø–æ—á–∞—Ç–æ–∫ ‚Äî —ñ –¥–µ –≤–æ–Ω–∞ –º–∞—î –∑–∞–∫—ñ–Ω—á–∏—Ç–∏—Å—å. –¶–µ —Ç–≤–æ—è –º–µ–∂–∞ –≤–æ–ª–æ–¥—ñ–Ω–Ω—è. –Ü —Ç–≤—ñ–π –ø—ñ–¥–ø–∏—Å. –¢—ñ–ª—å–∫–∏ –æ–¥–∏–Ω —Ä—É—Ö ‚Äî –∞–ª–µ –Ω–∞–∑–∞–≤–∂–¥–∏.",
            "fold": "–ó–∞—Ç–∏—Å–Ω–∏ –º–æ—ó —Ä—É–∫–∏. –ù–µ –ø–∏—Ç–∞–π –¥–æ–∑–≤–æ–ª—É. –ê —Ç–µ–ø–µ—Ä ‚Äî –ø–æ—Ü—ñ–ª—É–Ω–æ–∫, –ø–æ–≤—ñ–ª—å–Ω–∏–π —ñ –≤–ø–µ–≤–Ω–µ–Ω–∏–π. –ù–∞—á–µ —Ä–æ–∑–∫–ª–∞–¥–∞—î—à –º–µ–Ω–µ, —à–∞—Ä –∑–∞ —à–∞—Ä–æ–º. –Ø –º–∞—é –∑–¥–∞—Ç–∏—Å—å, –Ω–µ –≤–∏—Ä–≤–∞—Ç–∏—Å—å. –õ–∏—à–µ –≥—É–±–∏. –Ü —Ç–≤–æ—è —Å–∏–ª–∞.",
            "burn": "–ó–Ω–∞–π–¥–∏ –Ω–∞–π–≥–∞—Ä—è—á—ñ—à—É —Ç–æ—á–∫—É –Ω–∞ –º–æ—î–º—É —Ç—ñ–ª—ñ. –Ü —Ç–æ—Ä–∫–Ω–∏—Å—å —ó—ó, –Ω—ñ–±–∏ —Ü–µ –ø–æ–ª—É–º‚Äô—è. –ü–æ–≤—ñ–ª—å–Ω–æ. –ë–µ–∑ —Å—Ç—Ä–∞—Ö—É. –¢–≤—ñ–π –¥–æ—Ç–∏–∫ –º–∞—î –Ω–µ –æ–±–ø–µ–∫—Ç–∏ ‚Äî –∞ –∑–∞–ø–∞–ª–∏—Ç–∏. –©–æ–± –º–∏ –∑–∞–≥–æ—Ä—ñ–ª–∏—Å—å —Ä–∞–∑–æ–º. –Ü –Ω–µ –≥–∞—Å–ª–∏ —â–µ –¥–æ–≤–≥–æ.",
            "howl": "–ü—Ä–æ—à–µ–ø—á–∏ –º–æ—î —ñ–º‚Äô—è. –û–¥–∏–Ω —Ä–∞–∑. –ê–ª–µ —Ç–∞–∫, —â–æ–± —É –º–µ–Ω—ñ –≤—Å–µ –∑–∞–≤–º–µ—Ä–ª–æ. –ù—ñ–±–∏ —Ü–µ –º–æ–ª–∏—Ç–≤–∞ ‚Äî —ñ —Ç–∏ –±–æ—ó—à—Å—è, —â–æ –≤–æ–Ω–∞ –∑–Ω–∏–∫–Ω–µ –≤ –ø–æ–≤—ñ—Ç—Ä—ñ. –ü—ñ—Å–ª—è —Ü—å–æ–≥–æ ‚Äî –Ω—ñ—á–æ–≥–æ –Ω–µ –∫–∞–∂–∏. –î–∞–π –º–µ–Ω—ñ –≤—ñ–¥—á—É—Ç–∏ —Ç–∏—à—É.",
            "lace": "–ü–µ—Ä–µ–ø–ª–µ—Ç–∏ –Ω–∞—à—ñ —Ç—ñ–ª–∞ —Ç–∞–∫, —â–æ–± —è –Ω–µ –∑–º–æ–≥–ª–∞(–≤) –≤–∏–π—Ç–∏‚Ä¶ —ñ –Ω–µ –∑–∞—Ö–æ—Ç—ñ–ª–∞(–≤). –†—É–∫–∞–º–∏. –ù–æ–≥–∞–º–∏. –ü–æ–¥–∏—Ö–æ–º. –°—Ç–≤–æ—Ä–∏ –≤—É–∑–æ–ª —ñ–∑ –Ω–∞—Å –¥–≤–æ—Ö. –©–æ–± –Ω–∞–≤—ñ—Ç—å —Å–æ–Ω –Ω–µ –Ω–∞–≤–∞–∂–∏–≤—Å—è –Ω–∞—Å —Ä–æ–∑–ø–ª—É—Ç–∞—Ç–∏.",
            "drift": "–ü—Ä–æ–≤–µ–¥–∏ –ø–∞–ª—å—Ü–µ–º –ø–æ –º–æ—ó–π —à–∫—ñ—Ä—ñ, —è–∫ –≤—ñ—Ç–µ—Ä –ø–µ—Ä–µ–¥ –≥—Ä–æ–∑–æ—é ‚Äî –ª–µ–¥—å –≤—ñ–¥—á—É—Ç–Ω–æ, –∞–ª–µ –∑ –Ω–∞—Ç—è–∫–æ–º –Ω–∞ –±—É—Ä—é. –ù–µ –∑—É–ø–∏–Ω—è–π—Å—è, –ø–æ–∫–∏ —è –Ω–µ –ø–æ–¥–∏–≤–ª—é—Å—å –Ω–∞ —Ç–µ–±–µ. –Ü —Ç–æ–¥—ñ ‚Äî –∑–∞–º—Ä–∏. –î–∞–π –º–µ–Ω—ñ –≤–≥–∞–¥–∞—Ç–∏, —â–æ –±—É–¥–µ –¥–∞–ª—ñ.",
            "trace": "–î–æ—Å–ª—ñ–¥–∏ –º–æ—î —Ç—ñ–ª–æ, –Ω—ñ–±–∏ –º–∞–ø—É –Ω–µ–≤—ñ–¥–æ–º–æ—ó –∫—Ä–∞—ó–Ω–∏. –®—É–∫–∞–π –µ—Ä–æ–≥–µ–Ω–Ω—ñ –∑–æ–Ω–∏ –ø–æ–≤—ñ–ª—å–Ω–æ, –±–µ–∑ –ø–æ—Å–ø—ñ—Ö—É ‚Äî –ø–∞–ª—å—Ü—è–º–∏, –≥—É–±–∞–º–∏, –ø–æ–¥–∏—Ö–æ–º. –¢–≤–æ—î –∑–∞–≤–¥–∞–Ω–Ω—è ‚Äî –∑–Ω–∞–π—Ç–∏ —à–ª—è—Ö –¥–æ –∑–∞–¥–æ–≤–æ–ª–µ–Ω–Ω—è. –ê –º–æ—î ‚Äî –≤—ñ–¥–∫—Ä–∏—Ç–∏ –Ω–æ–≤—ñ –º–µ–∂—ñ.",
            "murmur": "–£—è–≤–∏, —â–æ –º–∏ –Ω–µ –∑–Ω–∞–π–æ–º—ñ. –ù–∞—Ö–∏–ª–∏—Å—å —ñ –ø—Ä–æ—à–µ–ø—á–∏ –º–µ–Ω—ñ —â–æ—Å—å, —á–∏–º —Å–ø–æ–∫—É—à–∞–≤(–ª–∞) –± –º–µ–Ω–µ –≤–ø–µ—Ä—à–µ. –¢—ñ–ª—å–∫–∏ –æ–¥–Ω–µ —Ä–µ—á–µ–Ω–Ω—è. –ê –ø–æ—Ç—ñ–º ‚Äî –∑–∞—Ç—Ä–∏–º–∞–π –ø–æ–≥–ª—è–¥. –ë–µ–∑ —É—Å–º—ñ—à–∫–∏. –ë–µ–∑ –ø–æ—è—Å–Ω–µ–Ω—å.",
            "sneak": "–ó—Ä–æ–±–∏ —Ç–µ, —á–æ–≥–æ —Ç–æ–±—ñ –Ω–∞–π–±—ñ–ª—å—à–µ —Ö–æ—á–µ—Ç—å—Å—è –∑–∞—Ä–∞–∑. –ê–ª–µ —Ä–∞–ø—Ç–æ–≤–æ. –ë–µ–∑ –ø–æ–ø–µ—Ä–µ–¥–∂–µ–Ω–Ω—è. –ù—ñ–±–∏ –º–∏ ‚Äî –≥—Ä–∞, –≤ —è–∫—ñ–π –¥–æ–∑–≤–æ–ª–µ–Ω–æ –≤—Å–µ. –û–¥–∏–Ω –ø–æ—Ä–∏–≤ ‚Äî —ñ –Ω—ñ—è–∫–∏—Ö –≤–∏–±–∞—á–µ–Ω—å.",
            "melt": "–ü—Ä–æ–≤–µ–¥–∏ —è–∑–∏–∫–æ–º –ø–æ –≤—É—à–∫—É ‚Äî –ø–æ–≤—ñ–ª—å–Ω–æ, –Ω—ñ–±–∏ —Ö–æ—á–µ—à —Ä–æ–∑—Ç–æ–ø–∏—Ç–∏. –ê –ø–æ—Ç—ñ–º –ø—Ä–æ—à–µ–ø–æ—á–∏ –æ–¥–Ω–µ –±–∞–∂–∞–Ω–Ω—è. –¢–µ, —è–∫–µ –∑–∞—Ä–∞–∑ –Ω–µ–º–æ–∂–ª–∏–≤–æ —Å—Ç—Ä–∏–º–∞—Ç–∏. –ù–µ—Ö–∞–π —è –≤—ñ–¥—á—É—é –π–æ–≥–æ‚Ä¶ —â–µ –¥–æ —Ç–æ–≥–æ, —è–∫ –≤–æ–Ω–æ –∑–¥—ñ–π—Å–Ω–∏—Ç—å—Å—è.",
            "nibble": "–£—è–≤–∏, —â–æ —è ‚Äî —Ç–≤—ñ–π —É–ª—é–±–ª–µ–Ω–∏–π –¥–µ—Å–µ—Ä—Ç. –°–∫—É—à—Ç—É–π –ø–æ–≤—ñ–ª—å–Ω–æ, –∑–∞—Ç—Ä–∏–º—É—é—á–∏ –∫–æ–∂–µ–Ω –¥–æ—Ç–∏–∫. –ù–µ –ø–æ—Å–ø—ñ—à–∞–π ‚Äî —Å–º–∞–∫ –º–∞—î —Ä–æ–∑–∫—Ä–∏—Ç–∏—Å—è —Å–∞–º. –û–¥–∏–Ω —É–∫—É—Å. –Ü –∑–∞—Ç–∏—à—à—è –ø—ñ—Å–ª—è –Ω—å–æ–≥–æ.",
            "grip": "–í—ñ–∑—å–º–∏ –º–µ–Ω–µ –º—ñ—Ü–Ω–æ. –ë–µ–∑ –ø–æ—è—Å–Ω–µ–Ω—å. –û–¥–∏–Ω —Ä–∞–∑. –ê–ª–µ —Ç–∞–∫, —â–æ–± —É —Ü—å–æ–º—É –¥–æ—Ç–∏–∫—É –±—É–ª–æ –≤—Å–µ ‚Äî —ñ –±–∞–∂–∞–Ω–Ω—è, —ñ –∫–æ–Ω—Ç—Ä–æ–ª—å, —ñ —Ç—Ä–æ—Ö–∏ –Ω–µ—Ç–µ—Ä–ø–ª—è—á–æ—Å—Ç—ñ.",
            "spill": "–°–∫–∞–∂–∏ –º–µ–Ω—ñ –æ–¥–Ω—É —Ñ–∞–Ω—Ç–∞–∑—ñ—é. –ù–∞–≤—ñ—Ç—å —è–∫—â–æ –≤–æ–Ω–∞ –±–æ–∂–µ–≤—ñ–ª—å–Ω–∞. –ê –º–æ–∂–µ ‚Äî —Å–∞–º–µ —Ç–æ–º—É. –í–∏–º–æ–≤ —ó—ó –≤–≥–æ–ª–æ—Å. –Ü –æ–¥—Ä–∞–∑—É –ø—ñ—Å–ª—è ‚Äî –ø–æ—Ü—ñ–ª—É–π, —â–æ–± —è –Ω–µ –≤—Å—Ç–∏–≥(–ª–∞) –≤—ñ–¥–ø–æ–≤—ñ—Å—Ç–∏. –õ–∏—à –¥–∏—Ö–∞–Ω–Ω—è —ñ –≤–æ–≥–æ–Ω—å.",
            "sway": "–ü—Ä–æ–≤–µ–¥–∏ —Ä—É–∫–æ—é –ø–æ –º–æ—î–º—É —Å—Ç–µ–≥–Ω—É ‚Äî –ø–æ–≤—ñ–ª—å–Ω–æ, —è–∫ —É —Ç–∞–Ω—Ü—ñ, —è–∫–∏–π –∑–Ω–∞—î —Ç—ñ–ª—å–∫–∏ –Ω–∞—à–µ —Ç—ñ–ª–æ. –ê –ø–æ—Ç—ñ–º –ø–æ—Ü—ñ–ª—É–π –º–µ–Ω–µ‚Ä¶ —è–∫ —â–µ –∂–æ–¥–Ω–æ–≥–æ —Ä–∞–∑—É. –°–º—ñ–ª–∏–≤—ñ—à–µ. –Ü–Ω–∞–∫—à–µ. –ü–æ-–Ω–∞—à–æ–º—É.",
            "trap": "–ü—ñ–¥–∫—Ä–∞–¥–∏—Å—è —ñ —Å—Ö–æ–ø–∏ –º–µ–Ω–µ –∑–Ω–µ–Ω–∞—Ü—å–∫–∞. –û–±—ñ–π–º–∏ —Ç–∞–∫, —â–æ–± –±—É–ª–æ –∑—Ä–æ–∑—É–º—ñ–ª–æ: —Ü–µ –ø–∞—Å—Ç–∫–∞. –ê–ª–µ –∑ —Ç–∏—Ö, –∑ —è–∫–∏—Ö –Ω–µ —Ö–æ—á–µ—Ç—å—Å—è –≤–∏–±–∏—Ä–∞—Ç–∏—Å—å.",
            "glitch": "–ó—Ä–æ–±–∏ —â–æ—Å—å, —á–æ–≥–æ —è –∑–æ–≤—Å—ñ–º –Ω–µ —á–µ–∫–∞—é. –ê–ª–µ –Ω–µ –ø—Ä–æ —Å–µ–∫—Å. –ó–∞–º—ñ—Å—Ç—å –¥–æ—Ç–∏–∫—É ‚Äî –º–∞—Å–∞–∂. –ó–∞–º—ñ—Å—Ç—å –ø–æ—Ü—ñ–ª—É–Ω–∫—É ‚Äî –∫–æ–≤–¥—Ä–∞ –Ω–∞ –ø–ª–µ—á—ñ. –ù–µ—Ö–∞–π –º—ñ–π —Ä–æ–∑—É–º –∑–∞–≤–∏—Å–Ω–µ‚Ä¶ –∞ —Ç—ñ–ª–æ –ø–æ–¥—è–∫—É—î.",
            "anchor": "–¢–æ—Ä–∫–Ω–∏—Å—å –¥–æ –º–µ–Ω–µ —Ç–∞–∫, –Ω—ñ–±–∏ —è ‚Äî —Å–ø–æ–∫—ñ–π, —è–∫–æ–≥–æ —Ç–∏ —à—É–∫–∞—î—à. –ó–∞—Ç—Ä–∏–º–∞–π –¥–æ—Ç–∏–∫. –Ü –∫–æ–ª–∏ –≤—ñ–¥—á—É—î—à, —â–æ –≤–∂–µ –≤–¥–æ–º–∞ ‚Äî –ø—Ä–æ—à–µ–ø–æ—á–∏ —Å–ª–æ–≤–æ. –û–¥–Ω–µ. –Ø –π–æ–≥–æ –∑–∞–ø–∞–º‚Äô—è—Ç–∞—é.",
        }
    }
}

def get_main_menu():
    markup = types.ReplyKeyboardMarkup(resize_keyboard=True)
    markup.add("üî∏ –©–æ —Ü–µ –∑–∞ –≥—Ä–∞?", "üí≥ –ö—É–ø–∏—Ç–∏", "üéÅ –ü–æ–¥–∞—Ä—É–≤–∞—Ç–∏ —ñ–Ω—à–æ–º—É", "üü† –ü–æ—á–∞—Ç–∏ –≥—Ä—É", "üí¨ –ó–∞–ø–∏—Ç–∞—Ç–∏ Foxie")
    return markup

def back_menu():
    return types.ReplyKeyboardMarkup(resize_keyboard=True).add("‚¨ÖÔ∏è –ù–∞–∑–∞–¥", "‚¨ÖÔ∏è –ì–æ–ª–æ–≤–Ω–µ –º–µ–Ω—é")

def shop_menu():
    markup = types.ReplyKeyboardMarkup(resize_keyboard=True)
    markup.add("üß° –ö—É–ø–∏—Ç–∏ Digital", "üî• –ö—É–ø–∏—Ç–∏ Lite Box")
    markup.add("‚¨ÖÔ∏è –ù–∞–∑–∞–¥", "‚¨ÖÔ∏è –ì–æ–ª–æ–≤–Ω–µ –º–µ–Ω—é")
    return markup

def gift_menu():
    markup = types.ReplyKeyboardMarkup(resize_keyboard=True)
    markup.add("üéÅ –ü–æ–¥–∞—Ä—É–≤–∞—Ç–∏ Digital ‚Äî 500 –≥—Ä–Ω", "üéÅ –ü–æ–¥–∞—Ä—É–≤–∞—Ç–∏ Lite Box ‚Äî 800 –≥—Ä–Ω")
    markup.add("‚¨ÖÔ∏è –ù–∞–∑–∞–¥", "‚¨ÖÔ∏è –ì–æ–ª–æ–≤–Ω–µ –º–µ–Ω—é")
    return markup

def level_choose_menu():
    markup = types.ReplyKeyboardMarkup(resize_keyboard=True)
    markup.add("üü† –†—ñ–≤–µ–Ω—å 1 (Original)", "üü£ –†—ñ–≤–µ–Ω—å 2 (Passion)")
    markup.add("‚¨ÖÔ∏è –ù–∞–∑–∞–¥", "‚¨ÖÔ∏è –ì–æ–ª–æ–≤–Ω–µ –º–µ–Ω—é")
    return markup

def game_menu():
    markup = types.ReplyKeyboardMarkup(resize_keyboard=True)
    markup.add("üß° –°–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥ –¥–ª—è –Ω–∞–ø–∏—Å—É")
    markup.add("‚¨ÖÔ∏è –ù–∞–∑–∞–¥", "‚¨ÖÔ∏è –ì–æ–ª–æ–≤–Ω–µ –º–µ–Ω—é")
    return markup

def after_game_menu():
    markup = types.ReplyKeyboardMarkup(resize_keyboard=True)
    markup.add("üîÅ –ü–æ—á–∞—Ç–∏ –∑–Ω–æ–≤—É", "üì© –ü–æ–¥—ñ–ª–∏—Ç–∏—Å—è –∑ –¥—Ä—É–≥–æ–º", "‚¨ÖÔ∏è –ì–æ–ª–æ–≤–Ω–µ –º–µ–Ω—é", "üö´ –í—ñ–¥–ø–∏—Å–∞—Ç–∏—Å—å")
    return markup

# ========== –õ–û–ì–Ü–ö–ê –ö–ù–û–ü–û–ö –ù–ê–ó–ê–î ==========
def handle_back(message):
    state = USER_STATE.get(message.from_user.id, {}).get("step", "")
    if state in ["about", "shop", "gift_choice"]:
        start(message)
    elif state.startswith("playing_") or state == "choose_level":
        send_level_choose(message.from_user.id)
    elif state == "wait_gift_for":
        present_gift(message)
    else:
        start(message)

# ========== –û–°–ù–û–í–ù–Ü –•–ï–ù–î–õ–ï–†–ò ==========
@bot.message_handler(commands=["start"])
def start(message):
    user_id = message.from_user.id
    USERS_DB.setdefault(user_id, {"level1": False, "level2": False, "joined": datetime.now().isoformat()})
    bot.send_message(user_id,
        "–ü—Ä–∏–≤—ñ—Ç.\n–¢–µ–±–µ —â–æ–π–Ω–æ –∑–∞–Ω–µ—Å–ª–æ –≤‚Ä¶ –≥—Ä—É.\n"
        "–¶–µ Foxie Code ‚Äî –≥—Ä–∞, –≤ —è–∫—ñ–π –≤–∏ –∑–∞–ø—É—Å–∫–∞—î—Ç–µ –±–∞–∂–∞–Ω–Ω—è –∑ –ª—ñ—Ö—Ç–∞—Ä–∏–∫–∞.\n\n"
        "–û–¥–∏–Ω —ñ–∑ –≤–∞—Å ‚Äî –∫–æ–º–∞–Ω–¥–∞. –Ü–Ω—à–∏–π ‚Äî —Å–≤—ñ—Ç–ª–æ.\n–¶–µ –≤–∏ + –≤–∞—à–∞ –ø—Ä–∏—Å—Ç—Ä–∞—Å—Ç—å.\n\n"
        "–í–∞–º –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ –Ω—ñ—á–æ–≥–æ –∑–Ω–∞—Ç–∏. –ü—Ä–æ—Å—Ç–æ –æ–±–µ—Ä–∏, –∑ —á–æ–≥–æ –ø–æ—á–∞—Ç–∏ ‚Üì",
        reply_markup=get_main_menu())
    USER_STATE[user_id] = {"step": "main_menu"}

@bot.message_handler(func=lambda m: m.text == "‚¨ÖÔ∏è –ì–æ–ª–æ–≤–Ω–µ –º–µ–Ω—é")
def to_main(message):
    start(message)

@bot.message_handler(func=lambda m: m.text == "‚¨ÖÔ∏è –ù–∞–∑–∞–¥")
def to_back(message):
    handle_back(message)

@bot.message_handler(func=lambda m: m.text == "üî∏ –©–æ —Ü–µ –∑–∞ –≥—Ä–∞?")
def what_is_game(message):
    bot.send_message(message.chat.id,
        "Foxie Code ‚Äî —Ü–µ –≥—Ä–∞ –¥–ª—è –ø–∞—Ä–∏.\n\n"
        "–ù–∞ —Ç—ñ–ª—ñ –æ–¥–Ω–æ–≥–æ –∑ –≤–∞—Å ‚Äî –∑‚Äô—è–≤–ª—è—é—Ç—å—Å—è –∫–æ–º–∞–Ω–¥–∏. "
        "–ù–µ–≤–∏–¥–∏–º–∏–º –º–∞—Ä–∫–µ—Ä–æ–º. –á—Ö –≤–∏–¥–Ω–æ —Ç—ñ–ª—å–∫–∏ –ø—ñ–¥ —Å–≤—ñ—Ç–ª–æ–º –ª—ñ—Ö—Ç–∞—Ä–∏–∫–∞.\n\n"
        "–î—Ä—É–≥–∏–π ‚Äî —à—É–∫–∞—î. –í–≤–æ–¥–∏—Ç—å —Ü—é –∫–æ–º–∞–Ω–¥—É —Å—é–¥–∏, –≤ –±–æ—Ç. –ê –ø–æ—Ç—ñ–º ‚Äî –≤–∏–∫–æ–Ω—É—î —Ç–µ, —â–æ —Å–∫–∞–∂–µ Foxie.\n\n"
        "–Ñ 20 –∫–æ–º–∞–Ω–¥. –ê–ª–µ –∫–æ–∂–Ω–∞ –∑ –Ω–∏—Ö ‚Äî –ø—Ä–æ –≤–∞—Å. –ü—Ä–æ –¥–æ—Ç–∏–∫, –¥—ñ—é, –º–æ–≤—á–∞–Ω–Ω—è. –Ü –±–∞–∂–∞–Ω–Ω—è.\n\n"
        "–ù–∞–≤—ñ—Ç—å —è–∫—â–æ —É –≤–∞—Å —Ç—ñ–ª—å–∫–∏ —Ä—É—á–∫–∞ –π —Ñ–∞–Ω—Ç–∞–∑—ñ—è ‚Äî –≥—Ä–∞ –≤–∂–µ –ø–æ—á–∞–ª–∞—Å—å.",
        reply_markup=back_menu())
    USER_STATE[message.from_user.id]["step"] = "about"

@bot.message_handler(func=lambda m: m.text == "üí¨ –ó–∞–ø–∏—Ç–∞—Ç–∏ Foxie")
def ask_foxie(message):
    bot.send_message(message.from_user.id, "–ù–∞–ø–∏—à–∏ —Ç—É—Ç –ø–∏—Ç–∞–Ω–Ω—è ‚Äî —ñ Foxie –≤—ñ–¥–ø–æ–≤—ñ—Å—Ç—å –æ—Å–æ–±–∏—Å—Ç–æ! ü¶ä", reply_markup=back_menu())
    USER_STATE[message.from_user.id]["step"] = "waiting_support"

@bot.message_handler(func=lambda m: USER_STATE.get(m.from_user.id, {}).get("step") == "waiting_support")
def send_support_message(message):
    text = f"Foxie! –ù–æ–≤–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤—ñ–¥ @{message.from_user.username} ({message.from_user.id}):\n\n{message.text}"
    bot.send_message(ADMIN_ID, text)
    bot.send_message(message.from_user.id, "–¢–≤–æ—î –ø–∏—Ç–∞–Ω–Ω—è –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ Foxie! –û—á—ñ–∫—É–π –≤—ñ–¥–ø–æ–≤—ñ–¥—å —É —Ü—å–æ–º—É —á–∞—Ç—ñ ü¶ä", reply_markup=get_main_menu())
    USER_STATE[message.from_user.id]["step"] = "main_menu"

@bot.message_handler(func=lambda m: m.text == "üí≥ –ö—É–ø–∏—Ç–∏")
def show_shop(message):
    bot.send_message(message.chat.id,
        "–û–±–µ—Ä–∏ —Å–≤–æ—é –≥—Ä—É Foxie Code:\n\n"
        "üß° Digital ‚Äî 500 –≥—Ä–Ω (–ª–∏—à–µ –≥—Ä–∞, –¥–æ—Å—Ç—É–ø –æ–¥—Ä–∞–∑—É –ø—ñ—Å–ª—è –æ–ø–ª–∞—Ç–∏)\n"
        "üî• Lite Box ‚Äî 800 –≥—Ä–Ω (–≥—Ä–∞ + –º–∞—Ä–∫–µ—Ä, –ª—ñ—Ö—Ç–∞—Ä–∏–∫, 2 —à–æ–∫–æ–ª–∞–¥–∫–∏, —Å–≤—ñ—á–∫–∞, –ª–∏—Å—Ç—ñ–≤–∫–∞ –∑ QR-–∫–æ–¥–æ–º)\n"
        "–î–æ—Å—Ç—É–ø –¥–æ –≥—Ä–∏ –≤—ñ–¥–∫—Ä–∏—î—Ç—å—Å—è –æ–¥—Ä–∞–∑—É –ø—ñ—Å–ª—è –æ–ø–ª–∞—Ç–∏.\n\n"
        "üéÅ –•–æ—á–µ—à –ø–æ–¥–∞—Ä—É–≤–∞—Ç–∏ –≥—Ä—É —ñ–Ω—à—ñ–π –ª—é–¥–∏–Ω—ñ?",
        reply_markup=shop_menu())
    USER_STATE[message.from_user.id]["step"] = "shop"

@bot.message_handler(func=lambda m: m.text == "üéÅ –ü–æ–¥–∞—Ä—É–≤–∞—Ç–∏ —ñ–Ω—à–æ–º—É")
def present_gift(message):
    bot.send_message(message.chat.id,
        "Foxie Code ‚Äî —Ü–µ —â–µ –π –Ω–µ–∑–≤–∏—á–Ω–∏–π –ø–æ–¥–∞—Ä—É–Ω–æ–∫ üíå –ì—Ä–∞, —è–∫–∞ –∑–∞–ª–∏—à–∞—î—Ç—å—Å—è –≤ –ø–∞–º‚Äô—è—Ç—ñ.\n"
        "–û–±–µ—Ä–∏, —è–∫–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç —Ç–∏ —Ö–æ—á–µ—à –ø–æ–¥–∞—Ä—É–≤–∞—Ç–∏:",
        reply_markup=gift_menu())
    USER_STATE[message.from_user.id]["step"] = "gift_choice"

@bot.message_handler(func=lambda m: m.text in [
    "üéÅ –ü–æ–¥–∞—Ä—É–≤–∞—Ç–∏ Digital ‚Äî 500 –≥—Ä–Ω", "üéÅ –ü–æ–¥–∞—Ä—É–≤–∞—Ç–∏ Lite Box ‚Äî 800 –≥—Ä–Ω"])
def buy_gift(message):
    bot.send_message(message.chat.id,
        "–ù–∞–ø–∏—à–∏, –±—É–¥—å –ª–∞—Å–∫–∞, –¥–ª—è –∫–æ–≥–æ —Ü–µ–π –ø–æ–¥–∞—Ä—É–Ω–æ–∫ (–Ω—ñ–∫ –∞–±–æ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω—É):",
        reply_markup=back_menu())
    USER_STATE[message.from_user.id]["step"] = "wait_gift_for"

@bot.message_handler(func=lambda m: USER_STATE.get(m.from_user.id, {}).get("step") == "wait_gift_for")
def get_gift_for(message):
    user_id = message.from_user.id
    gift_code = f"fox{user_id}{int(time.time())%10000}"
    GIFT_CODES[gift_code] = {"used": False, "for_id": None, "from_id": user_id}
    bot.send_message(user_id,
        f"–ü—Ä–∏–≤—ñ—Ç! –¢–æ–±—ñ –ø–æ–¥–∞—Ä—É–≤–∞–ª–∏ –≥—Ä—É Foxie Code.\n"
        f"–ü—Ä–æ—Å—Ç–æ –∑–∞–π–¥–∏ –≤ –±–æ—Ç —ñ –≤–≤–µ–¥–∏ —Ü–µ–π –∫–æ–¥:\n‚ù§Ô∏è{gift_code}\nFoxie —á–µ–∫–∞—î –Ω–∞ —Ç–µ–±–µ!\n(–ö–æ–¥ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –ª–∏—à–µ –æ–¥–∏–Ω —Ä–∞–∑.)",
        reply_markup=get_main_menu())
    start(message)

@bot.message_handler(func=lambda m: m.text == "üß° –ö—É–ø–∏—Ç–∏ Digital")
def buy_digital(message):
    user_id = message.from_user.id
    ALLOWED_USERS.add(user_id)
    USERS_DB[user_id]["level1"] = False
    USERS_DB[user_id]["level2"] = False
    bot.send_message(user_id, "–î—è–∫—É—î–º–æ –∑–∞ –æ–ø–ª–∞—Ç—É üß°\n–¢–≤–æ—è –Ω—ñ—á ‚Äî –ø–æ—á–∏–Ω–∞—î—Ç—å—Å—è –ø—Ä–æ—Å—Ç–æ –∑–∞—Ä–∞–∑.",
                     reply_markup=level_choose_menu())
    send_level_choose(user_id)

@bot.message_handler(func=lambda m: m.text == "üî• –ö—É–ø–∏—Ç–∏ Lite Box")
def buy_lite_box(message):
    user_id = message.from_user.id
    ALLOWED_USERS.add(user_id)
    USERS_DB[user_id]["level1"] = False
    USERS_DB[user_id]["level2"] = False
    bot.send_message(user_id,
        "–î—è–∫—É—î–º–æ –∑–∞ –æ–ø–ª–∞—Ç—É! –¢–µ–ø–µ—Ä —Ç–≤–æ—è –≥—Ä–∞ Foxie Code –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–∞.\n\n–î–ª—è Lite Box –Ω–∞–ø–∏—à–∏: –ü–Ü–ë, —Ç–µ–ª–µ—Ñ–æ–Ω, –º—ñ—Å—Ç–æ —Ç–∞ –≤—ñ–¥–¥—ñ–ª–µ–Ω–Ω—è –ù–æ–≤–æ—ó –ü–æ—à—Ç–∏.",
        reply_markup=level_choose_menu())
    send_level_choose(user_id)

def send_level_choose(user_id):
    bot.send_message(user_id, "–û–±–µ—Ä–∏ —Ä—ñ–≤–µ–Ω—å –≥—Ä–∏:", reply_markup=level_choose_menu())
    USER_STATE[user_id]["step"] = "choose_level"

@bot.message_handler(func=lambda m: m.text in ["üü† –†—ñ–≤–µ–Ω—å 1 (Original)", "üü£ –†—ñ–≤–µ–Ω—å 2 (Passion)"])
def choose_level(message):
    user_id = message.from_user.id
    level = "1" if "–†—ñ–≤–µ–Ω—å 1" in message.text else "2"
    USER_STATE[user_id]["step"] = f"playing_{level}"
    USER_STATE[user_id]["level"] = level
    USER_STATE[user_id]["commands"] = []
    bot.send_message(user_id,
        "–ì—Ä–∞ –ø–æ—á–∞–ª–∞—Å—å ü¶ä\n\n"
        "–û–¥–∏–Ω —ñ–∑ –≤–∞—Å ‚Äî –ø–∏—à–µ –∫–æ–º–∞–Ω–¥–∏ –Ω–∞ —Ç—ñ–ª—ñ.\n–î—Ä—É–≥–∏–π ‚Äî —à—É–∫–∞—î. –Ü –∫–æ–ª–∏ –∑–Ω–∞—Ö–æ–¥–∏—Ç—å ‚Äî –≤–≤–æ–¥–∏—Ç—å —Å–ª–æ–≤–æ —Å—é–¥–∏, –≤ –±–æ—Ç.\n"
        "Foxie –≤—ñ–¥–ø–æ–≤—ñ—Å—Ç—å‚Ä¶ –±–∞–∂–∞–Ω–Ω—è–º üòà\n\n"
        "–ú–æ–∂–µ—à —É –±—É–¥—å-—è–∫–∏–π –º–æ–º–µ–Ω—Ç –Ω–∞—Ç–∏—Å–Ω—É—Ç–∏ üß° –°–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥ –¥–ª—è –Ω–∞–ø–∏—Å—É, ‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –∞–±–æ ‚¨ÖÔ∏è –ì–æ–ª–æ–≤–Ω–µ –º–µ–Ω—é!",
        reply_markup=game_menu())

@bot.message_handler(func=lambda m: m.text == "üß° –°–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥ –¥–ª—è –Ω–∞–ø–∏—Å—É")
def show_commands(message):
    user_id = message.from_user.id
    level = USER_STATE.get(user_id, {}).get("level", "1")
    block = COMMANDS_LIST[level]
    lines = [f"‚Ä¢ {cmd} ‚Äî {place}" for cmd, place in block["words"].items()]
    bot.send_message(user_id, "–û—Å—å —Ç–≤—ñ–π —Å–ø–∏—Å–æ–∫ —ñ–∑ 20 –∫–æ–º–∞–Ω–¥ üß°\n\n" + "\n".join(lines), reply_markup=game_menu())

@bot.message_handler(func=lambda m: m.text == "üü† –ü–æ—á–∞—Ç–∏ –≥—Ä—É")
def try_start_game(message):
    user_id = message.from_user.id
    if user_id not in ALLOWED_USERS:
        bot.send_message(user_id, "–¶–µ –∑–∞–∫—Ä–∏—Ç–∞ –≥—Ä–∞. –°–ø–µ—Ä—à—É –∫—É–ø–∏ –¥–æ—Å—Ç—É–ø –∞–±–æ –∞–∫—Ç–∏–≤—É–π –ø–æ–¥–∞—Ä—É–Ω–∫–æ–≤–∏–π –∫–æ–¥ ‚ù§Ô∏è",
                         reply_markup=get_main_menu())
        return
    send_level_choose(user_id)

@bot.message_handler(func=lambda m: USER_STATE.get(m.from_user.id, {}).get("step", "").startswith("playing_"))
def process_game(message):
    user_id = message.from_user.id
    level = USER_STATE[user_id]["level"]
    cmds = COMMANDS_LIST[level]["words"]
    replies = COMMANDS_LIST[level]["replies"]
    input_word = message.text.strip().lower()
    # –ö–Ω–æ–ø–∫–∏ –≤ –≥—Ä—ñ
    if message.text == "‚¨ÖÔ∏è –ì–æ–ª–æ–≤–Ω–µ –º–µ–Ω—é":
        start(message)
        return
    if message.text == "‚¨ÖÔ∏è –ù–∞–∑–∞–¥":
        send_level_choose(user_id)
        return
    if message.text == "üß° –°–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥ –¥–ª—è –Ω–∞–ø–∏—Å—É":
        show_commands(message)
        return
    # –ü–∞—Å—Ö–∞–ª–∫–∏
    if input_word in EASTER_EGGS:
        bot.send_message(user_id, EASTER_EGGS[input_word], reply_markup=game_menu())
        return
    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞
    if input_word not in cmds:
        bot.send_message(user_id, "–ü—Ñ—Ñ‚Ä¶ –¢–∞–∫–æ—ó –∫–æ–º–∞–Ω–¥–∏ –≤ –º–µ–Ω–µ –Ω–µ–º–∞—î ü¶ä –°–ø—Ä–æ–±—É–π —â–µ.", reply_markup=game_menu())
        return
    if input_word in USER_STATE[user_id]["commands"]:
        bot.send_message(user_id, "–¶–µ —Å–ª–æ–≤–æ –≤–∂–µ –±—É–ª–æ. –í–≤–µ–¥–∏ —ñ–Ω—à–µ ü¶ä", reply_markup=game_menu())
        return
    USER_STATE[user_id]["commands"].append(input_word)
    bot.send_message(user_id, replies[input_word], reply_markup=game_menu())
    if len(USER_STATE[user_id]["commands"]) == 20:
        finish_game(user_id, level)
    else:
        bot.send_message(user_id, "ü¶ä –ß–µ–∫–∞—é –Ω–∞ –Ω–∞—Å—Ç—É–ø–Ω–µ —Å–ª–æ–≤–æ‚Ä¶", reply_markup=game_menu())

def finish_game(user_id, level):
    USERS_DB[user_id][f"level{level}"] = True
    bot.send_message(user_id, "Foxie –∑ –≤–∞–º–∏ –ø—Ä–æ—â–∞—î—Ç—å—Å—è‚Ä¶ –¥–æ –Ω–∞—Å—Ç—É–ø–Ω–æ—ó –≥—Ä–∏ ü¶ä", reply_markup=after_game_menu())
    bot.send_message(user_id, "–û—Ü—ñ–Ω–∏ –≥—Ä—É –≤—ñ–¥ 1 –¥–æ 5 (–¥–µ 5 ‚Äî —Å—É–ø–µ—Ä!):")
    USER_STATE[user_id]["step"] = "rate_game"

@bot.message_handler(func=lambda m: USER_STATE.get(m.from_user.id, {}).get("step") == "rate_game")
def rate_game(message):
    rate = message.text.strip()
    if rate in ["1", "2", "3", "4", "5"]:
        bot.send_message(ADMIN_ID, f"–û—Ü—ñ–Ω–∫–∞ –≥—Ä–∏ –≤—ñ–¥ @{message.from_user.username} ({message.from_user.id}): {rate}")
        bot.send_message(message.from_user.id,
            "–î—è–∫—É—é –∑–∞ –æ—Ü—ñ–Ω–∫—É! Foxie —Ä–∞–¥—ñ—î –≤—ñ–¥–≥—É–∫–∞–º ü¶ä\n"
            "–ü—ñ–¥–ø–∏—à–∏—Å—å –Ω–∞ Instagram ‚Äî —Ç—É—Ç —â–µ –±—ñ–ª—å—à–µ —ñ–¥–µ–π: https://www.instagram.com/foxie_code/",
            reply_markup=after_game_menu())
        USER_STATE[message.from_user.id]["step"] = "main_menu"
    else:
        bot.send_message(message.from_user.id, "–í–≤–µ–¥–∏ –æ—Ü—ñ–Ω–∫—É –≤—ñ–¥ 1 –¥–æ 5. Foxie –Ω–µ –æ–±—Ä–∞–∑–∏—Ç—å—Å—è! üòâ")

@bot.message_handler(func=lambda m: m.text == "üîÅ –ü–æ—á–∞—Ç–∏ –∑–Ω–æ–≤—É")
def restart_game(message):
    send_level_choose(message.from_user.id)

@bot.message_handler(func=lambda m: m.text == "üì© –ü–æ–¥—ñ–ª–∏—Ç–∏—Å—è –∑ –¥—Ä—É–≥–æ–º")
def share_with_friend(message):
    bot.send_message(message.chat.id,
        "ü¶ä –•–æ—á–µ—à –ø–æ–¥—ñ–ª–∏—Ç–∏—Å—è Foxie –∑ –¥—Ä—É–≥–æ–º?\n–ù–∞—Ç–∏—Å–Ω–∏ –π –Ω–∞–¥—ñ—à–ª–∏ –π–æ–º—É –ª—ñ–Ω–∫ –Ω–∞ –Ω–∞—à–æ–≥–æ –±–æ—Ç–∏–∫–∞:\nhttps://t.me/FoxieCodeBot\n"
        "–ê–ª–µ —Ç—ñ–ª—å–∫–∏ —Ç—Å—Å‚Ä¶ –≥—Ä–∞ –≤—ñ–¥–∫—Ä–∏—î—Ç—å—Å—è —Ç—ñ–ª—å–∫–∏ –ø—ñ—Å–ª—è –æ–ø–ª–∞—Ç–∏ –∞–±–æ –∑ –∫–æ–¥–æ–º-–ø–æ–¥–∞—Ä—É–Ω–∫–æ–º üòâ",
        reply_markup=after_game_menu()
    )

@bot.message_handler(func=lambda m: m.text == "üö´ –í—ñ–¥–ø–∏—Å–∞—Ç–∏—Å—å")
def unsubscribe(message):
    user_id = message.from_user.id
    if user_id in ALLOWED_USERS:
        ALLOWED_USERS.remove(user_id)
    bot.send_message(user_id, "Foxie –±—ñ–ª—å—à–µ –Ω–µ –±—É–¥–µ —Ç—É—Ä–±—É–≤–∞—Ç–∏ ü¶ä –ê–ª–µ —Ç–∏ –∑–∞–≤–∂–¥–∏ –º–æ–∂–µ—à –ø–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—å —É –≥—Ä—É, –ø—Ä–æ—Å—Ç–æ –Ω–∞–ø–∏—Å–∞–≤—à–∏ —Å—é–¥–∏ üíå", reply_markup=get_main_menu())
    USER_STATE[user_id]["step"] = "main_menu"

@bot.message_handler(func=lambda m: m.text and m.text.lower().startswith("fox"))
def enter_gift_code(message):
    user_id = message.from_user.id
    code = message.text.strip()
    if code not in GIFT_CODES:
        bot.send_message(user_id, "–ö–æ–¥ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ –∞–±–æ –≤–∂–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π.", reply_markup=get_main_menu())
        return
    if GIFT_CODES[code]["used"]:
        bot.send_message(user_id, "–ö–æ–¥ –≤–∂–µ –±—É–≤ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π. –°–ø—Ä–æ–±—É–π —ñ–Ω—à–∏–π –∞–±–æ –∫—É–ø–∏ —Å–≤–æ—é Foxie Code!",
                         reply_markup=get_main_menu())
        return
    ALLOWED_USERS.add(user_id)
    GIFT_CODES[code]["used"] = True
    GIFT_CODES[code]["for_id"] = user_id
    bot.send_message(user_id, "–ö–æ–¥ –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–æ! Foxie Code –≥–æ—Ç–æ–≤–∞ üî•\n–ü–æ–ø–µ—Ä–µ–¥—É ‚Äî 20 –∫–æ–º–∞–Ω–¥. –û–¥–Ω–∞ –∑–∞ –æ–¥–Ω–æ—é, –∑—Ä–æ—Å—Ç–∞—é—á–∏ –≤ –Ω–∞–ø—Ä—É–∑—ñ –π –±–∞–∂–∞–Ω–Ω—ñ.",
                     reply_markup=level_choose_menu())
    send_level_choose(user_id)

@bot.message_handler(func=lambda m: m.text and m.text.strip().lower() in EASTER_EGGS)
def handle_easter(message):
    bot.send_message(message.chat.id, EASTER_EGGS[message.text.strip().lower()])

@bot.message_handler(commands=["id"])
def show_id(message):
    bot.send_message(message.chat.id, f"–¢–≤—ñ–π Telegram ID: {message.from_user.id}")

# === –ê–¥–º—ñ–Ω-–∫–æ–º–∞–Ω–¥–∏ ===
@bot.message_handler(commands=["add"])
def add_user(message):
    if message.from_user.id != ADMIN_ID:
        return
    parts = message.text.split()
    if len(parts) != 2:
        bot.send_message(ADMIN_ID, "–§–æ—Ä–º–∞—Ç: /add [id]")
        return
    try:
        add_id = int(parts[1])
        ALLOWED_USERS.add(add_id)
        bot.send_message(ADMIN_ID, f"üü¢ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑ ID {add_id} –¥–æ–¥–∞–Ω–æ –¥–æ —Å–ø–∏—Å–∫—É –¥–æ–∑–≤–æ–ª–µ–Ω–∏—Ö.")
    except Exception:
        bot.send_message(ADMIN_ID, "ID –º–∞—î –±—É—Ç–∏ —á–∏—Å–ª–æ–º.")

@bot.message_handler(commands=["—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞"])
def show_stats(message):
    if message.from_user.id != ADMIN_ID:
        return
    total = len(ALLOWED_USERS)
    level1 = sum(1 for u in USERS_DB if USERS_DB[u].get("level1"))
    level2 = sum(1 for u in USERS_DB if USERS_DB[u].get("level2"))
    gifts = sum(1 for c in GIFT_CODES if GIFT_CODES[c]["used"])
    text = (
        f"ü¶ä Foxie Code ‚Äî —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:\n"
        f"–ì—Ä–∞–ª–∏: {total}\n"
        f"–ü—Ä–æ–π—à–ª–∏ —Ä—ñ–≤–µ–Ω—å 1: {level1}\n"
        f"–ü—Ä–æ–π—à–ª–∏ —Ä—ñ–≤–µ–Ω—å 2: {level2}\n"
        f"–ö—É–ø–∏–ª–∏ –Ω–∞ –ø–æ–¥–∞—Ä—É–Ω–æ–∫: {gifts}\n"
        f"–í—Å—å–æ–≥–æ gift-–∫–æ–¥—ñ–≤: {len(GIFT_CODES)}"
    )
    bot.send_message(ADMIN_ID, text)

# === –ó–∞–ø—É—Å–∫ ===
if __name__ == "__main__":
    print("Foxie Code –∑–∞–ø—É—â–µ–Ω–æ ü¶ä")
    bot.infinity_polling(timeout=10, long_polling_timeout=5)
